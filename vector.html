<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Swapnil Meshram's portfolio showcasing his work for Team Vector where he built robot circuitry and various robots for ABU Robocon.">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Swapnil Meshram</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="50x50" href="images/swapnil_fav.jpg" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <noscript><link rel="stylesheet" href="assets/css/noscript.css"></noscript>

    <!-- Preload the chevron font so it’s cached early -->
    <link rel="preload"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/webfonts/fa-solid-900.woff2"
      as="font" type="font/woff2" crossorigin>

    <!-- FontAwesome for zoom icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />

    <!-- Slick Carousel CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css" />
    
<style>
/* ───────────── General UI ───────────── */

/* Fade transition for overlay image swaps */
.fullscreen-image img.zoomable{
  cursor:grab;
  touch-action:none;
  transform-origin:center center;
  transition:opacity .4s ease,transform .1s ease-out;
}

/* Fade each <video> exactly like each <img> */
.fullscreen-video video{
  opacity:1;
  transition:opacity .4s ease;
}

/* ───── Slick arrows (Font-Awesome chevrons) ───── */
.slick-prev,
.slick-next{
  background:none;
  border:none!important;
  outline:0;
  box-shadow:none;
  width:50px;
  height:50px;
  cursor:pointer;
  position:absolute;
  top:50%;
  transform:translateY(-50%);
}
.slick-prev{left:-60px;}
.slick-next{right:-60px;}

.slick-prev:before,
.slick-next:before{
  font-family:"Font Awesome 5 Free";
  font-weight:900;
  font-size:48px;
  line-height:1;
  color:rgba(50,50,50,.9);
}
.slick-prev:before{content:"\f053";}
.slick-next:before{content:"\f054";}

.slick-prev:hover:before,
.slick-next:hover:before{color:#283a8b;}

/* Inline-carousel arrow sizing */
@media (max-width:768px){
  .slick-prev,.slick-next{width:34px;height:34px;}
  .slick-prev:before,.slick-next:before{font-size:30px;}
}
@media (max-width:480px){
  .slick-prev,.slick-next{width:30px;height:30px;}
  .slick-prev:before,.slick-next:before{font-size:26px;}
  .slick-prev{left:-30px;}
  .slick-next{right:-30px;}
}

/* ─── Overlay-specific arrow buttons ─── */
.fs-arrow{
  background:none;
  border:none;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
  cursor:pointer;
}

/* Hide Slick’s built-in chevrons **only** when .fs-arrow is present */
.fs-arrow:before{content:none!important;}

/* Hover/active feedback */
.fs-arrow:active i,
.fs-arrow:hover  i{transform:scale(1.15);}

/* Icon style; size is set with a variable later */
.fs-arrow i{
  color:#fff;
  line-height:1;
  filter:drop-shadow(0 0 4px rgba(0,0,0,.4));
}

/* Phones ≤480 px (inline carousels only) */
@media (max-width:480px){
  .fs-arrow{width:28px;height:28px;}
  .fs-arrow i{font-size:1.45rem;} /* ≈23 px */
}

/* ───────────── Dots / layout / misc ───────────── */
.image-label,.video-label{
  text-align:center;
  font-size:16px;
  margin-top:5px;
  color:rgba(50,50,50);
}
.image-citation,.video-citation{
  margin-top:5px;
  font-size:12px;
  text-align:center;
}

.slick-dots{
  position:absolute;
  bottom:10px;
  width:100%;
  text-align:center;
}
.slider{
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  position:relative;
}
.slider .slide-content{
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  margin:20px 0;
}

/* Hollow rings for Slick dots */
.slick-dots li button{
  border:none!important;
  background:transparent!important;
  padding:0;
  outline:none;
}
.slick-dots li button:before{
  content:'';
  display:inline-block;
  width:12px;height:12px;
  border:2px solid rgba(50,50,50,.7);
  border-radius:50%;
  margin:0 6px;
  transition:background .2s ease,transform .2s ease;
}
.slick-dots li button:hover:before{transform:scale(1.2);}
.slick-dots li.slick-active button:before{
  background:#283a8b;
  border-color:#283a8b;
}

.video-container{position:relative;width:100%;max-width:600px;margin:0 auto;}
.slider .slide-content img,
.slider .slide-content video{
  max-width:600px;width:100%;height:auto;
  display:block;margin:0 auto;
  border:1px solid rgba(50,50,50);
  padding:6px;
}
@media(max-width:600px){
  .slider .slide-content img,
  .slider .slide-content video{padding:5px;}
}

/* Hover scale */
.image,.video{cursor:pointer;transition:transform .25s ease;}
.image:hover,.video:hover{transform:scale(1.01);}

/* ───────────── Full-screen overlay wrappers ───────────── */
.fullscreen-video,
.fullscreen-image{
  position:fixed;top:0;left:0;width:100%;height:100vh;
  background:rgba(0,0,0,.8);
  z-index:9999;
  display:flex;justify-content:center;align-items:center;
  touch-action:none;
}
.fullscreen-video video {
  opacity: 1;
  transition: opacity .4s ease;
  transform: scale(0.85);
  transform-origin: center center;
}

@supports(height:100dvh){
  .fullscreen-video,
  .fullscreen-image{height:100dvh;}  /* iOS Chrome fix */
}

.fullscreen-video video,
.fullscreen-image img{max-width:90%;max-height:90%;}

.blurred-background{filter:blur(5px);}
.close-button{
  position:absolute;top:25px;right:25px;
  width:32px;height:32px;
  background:url('images/close-icon.png') no-repeat center/cover;
  cursor:pointer;z-index:10000;
}

/* Zoom controls */
.zoom-controls {
  position: absolute;         /* take it out of the flow */
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;    /* vertical / horizontal padding */
  background: rgba(0,0,0,0.6);
  border-radius: 9999px;      /* fully rounded ends */
  bottom: 1rem;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10001;

  /* start hidden & fade-in on hover/focus */
  opacity: 0;
  transition: opacity 0.3s ease;
  }

  .fullscreen-image:hover .zoom-controls,
  .zoom-controls:focus-within {
    opacity: 1;
}

.zoom-btn {
  background: transparent;    /* remove per-button circle */
  border: none;
  width: auto; height: auto;  /* let padding define hit area */
  padding: 0.25rem;           /* click‐area around the icon */
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: #fff !important;     /* icon color */
  font-size: 1rem;            /* scale the icon up a bit */
}

.zoom-btn:hover {
  background: rgba(255,255,255,0.15);
  border-radius: 50%;
}

/* Responsive project text */
.project-text{font-size:1.175rem;line-height:1.6;}
@media(max-width:1280px){.project-text{font-size:1.1rem;}}
@media(max-width:736px){.project-text{font-size:1rem;}}

/* Play icon overlay on videos */
.play-icon{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  width:64px;height:64px;
  background:url('images/play-icon.png') no-repeat center/cover;
  opacity:.8;cursor:pointer;
}
.play-icon:hover{transform:translate(-50%,-50%) scale(1.2);}
@media(max-width:480px){.play-icon{top:50%;}}

/* ─── Base overlay-arrow positioning ─── */
.fullscreen-image .slick-prev,
.fullscreen-video .slick-prev,
.fullscreen-image .slick-next,
.fullscreen-video .slick-next{
  top:50%;
  transform:translateY(-50%);
  z-index:10001;
}

/* ───────── FULL-SCREEN-ONLY arrow sizing (single variable) ───────── */
.fullscreen-image,
.fullscreen-video{ --fs-arrow-size:48px; }      /* desktop */
@media (max-width:768px){
  .fullscreen-image,
  .fullscreen-video{ --fs-arrow-size:34px; }    /* tablets */
}
@media (max-width:480px){
  .fullscreen-image,
  .fullscreen-video{ --fs-arrow-size:28px; }    /* phones */
}
.fullscreen-image .fs-arrow,
.fullscreen-video .fs-arrow{
  width:var(--fs-arrow-size);
  height:var(--fs-arrow-size);
}
.fullscreen-image .fs-arrow i,
.fullscreen-video .fs-arrow i{
  font-size:var(--fs-arrow-size);
}

/* Absolutely hide any Slick pseudo-glyph that might still appear */
.fullscreen-image .slick-prev:before,
.fullscreen-image .slick-next:before,
.fullscreen-video .slick-prev:before,
.fullscreen-video .slick-next:before{content:none!important;}

/* ────────────────────────────────────────────────
   𝗙𝗶𝘅𝗲𝗱-𝗼𝗳𝗳𝘀𝗲𝘁 𝗮𝗿𝗿𝗼𝘄 𝗹𝗮𝘆𝗼𝘂𝘁  (matches SLAM page)
   ──────────────────────────────────────────────── */

/* Desktop / large screens */
.fullscreen-image .slick-prev,
.fullscreen-video .slick-prev{
  left:calc((100% - 90%) / 2 + .5rem)!important;
  right:auto!important;
}
.fullscreen-image .slick-next,
.fullscreen-video .slick-next{
  right:calc((100% - 90%) / 2 + .5rem)!important;
  left:auto!important;
}

/* Tablets ≤ 768 px */
@media (max-width:768px){
  .fullscreen-image .slick-prev,
  .fullscreen-video .slick-prev{left:1rem!important;}
  .fullscreen-image .slick-next,
  .fullscreen-video .slick-next{right:1rem!important;}
}

/* Phones ≤ 480 px */
@media (max-width:480px){
  .fullscreen-image .slick-prev,
  .fullscreen-video .slick-prev{left:.5rem!important;}
  .fullscreen-image .slick-next,
  .fullscreen-video .slick-next{right:.5rem!important;}
}
</style>

</head>
<body class="is-preload">

<!-- Header -->
<header id="header">
    <a href="index.html#three" class="title">From Circuit Boards to Robots: Projects in Embedded Systems & Robotics</a>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
        </ul>
    </nav>
</header>

<!-- Wrapper -->
<div id="wrapper">

    <!-- Main -->
    <section id="main" class="wrapper">
        <div class="inner">
            <h1 class="major">Team Vector</h1>
            <div class="slider">
                <div class="slide-content">
                    <a href="images/Team Vector_Autonomous Robot.JPG" class="image" onclick="showFullScreenImage('images/Team Vector_Autonomous Robot.JPG'); return false;">
                        <img src="images/Team Vector_Autonomous Robot.png" alt="Autonomous Shuttle Launching Robot" loading="lazy">
                    </a>
                    <p class="image-label">Image 1: Autonomous Shuttle Launching Robot</p>
                </div>
                <div class="slide-content">
                    <a href="images/Team Vector_Manual Robot.jpg" class="image" onclick="showFullScreenImage('images/Team Vector_Manual Robot.jpg'); return false;">
                        <img src="images/Team Vector_Manual Robot.png" alt="Manual Robot - responsible for shuttlecock transfer to the Autonomous Robot" loading="lazy">
                    </a>
                    <p class="image-label">Image 2: Manual Robot - responsible for shuttlecock transfer to the Autonomous Robot.</p>
                </div>
                <div class="slide-content">
                    <div class="video-container">
                        <video class="video" muted>
                            <source src="images/Team Vector__Shuttle Launching Autonomous Robot.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="play-icon" onclick="playFullScreen('images/Team Vector__Shuttle Launching Autonomous Robot.mp4', true)"></div>
                    </div>
                    <p class="video-label">Video 1: Autonomous Shuttle Launching Robot (Locomotion Test)</p>
                </div>
                <div class="slide-content">
                    <div class="video-container">
                        <video class="video" muted>
                            <source src="images/Team Vector_Shuttle Launching Autonomous and Manual Robot (Testing).mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="play-icon" onclick="playFullScreen('images/Team Vector_Shuttle Launching Autonomous and Manual Robot (Testing).mp4', true)"></div>
                    </div>
                    <p class="video-label">Video 2: Autonomous Shuttle Launching Robot & Manual Robot (Successful task completion)</p>
                </div>
                <div class="slide-content">
                    <div class="video-container">
                        <video class="video" muted>
                            <source src="images/Team Vector_MR2 LOCOMOTION.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="play-icon" onclick="playFullScreen('images/Team Vector_MR2 LOCOMOTION.mp4', true)"></div>
                    </div>
                    <p class="video-label">Video 3: Autonomous Quadruped Robot (Trot Gait Analysis)</p>
                </div>
                <div class="slide-content">
                    <div class="video-container">
                        <video class="video" muted>
                            <source src="images/Team Vector_Gerge holding & Passing Mechanism.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="play-icon" onclick="playFullScreen('images/Team Vector_Gerge holding & Passing Mechanism.mp4', true)"></div>
                    </div>
                    <p class="video-label">Video 4: Autonomous Robot (Gerge Holding & Passing)</p>
                </div>
                <div class="slide-content">
                    <div class="video-container">
                        <video class="video" muted>
                            <source src="images/Team Vector_SHAGAI LOADING AND THROWING.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="play-icon" onclick="playFullScreen('images/Team Vector_SHAGAI LOADING AND THROWING.mp4', true)"></div>
                    </div>
                    <p class="video-label">Video 5: Manual Robot (Shagai Loading & Throwing)</p>
                </div>
                <!-- Add more images as needed -->
            </div>
            <p class="text-justify project-text">As a core team member, I led and collaborated with a 40-member robotics team in ABU Robocon India, a prestigious pan-Asian robotics competition. My responsibilities encompassed the design, manufacturing, testing, and integration of power and logic interfaces for both manual and autonomous robots.</p>
            <p class="text-justify project-text"><strong><u>Shuttle Launching Autonomous Robot and Manual Robot</u></strong> <a href="https://www.youtube.com/watch?v=GAjVA2u-_1s" target="_blank">(ABU Robocon 2018)</a><strong>: </strong>As part of a collaborative team effort, we designed and developed two robots—a manually operated robot and a fully autonomous robot. The manual robot plays a crucial role in transferring shuttlecocks to the autonomous robot. The team collectively developed a differential-driven autonomous robot and engineered a pneumatically actuated hardware system, seamlessly integrating it into the autonomous robot's catapult mechanism that can launch shuttles through circular hoops using a pneumatic actuator. In addition to our collective work, I played a key role in designing custom hardware, conducting sensor testing, optimizing pneumatic actuators, managing motor control, and creating new components within schematic and footprint layouts.</p>
            <p class="text-justify project-text"><strong><u>Autonomous Quadruped Robot and Manual Robot</u></strong> <a href="https://www.youtube.com/watch?v=u6gRn_0Jz0c" target="_blank">(ABU Robocon 2019)</a><strong>: </strong>As a team, we successfully developed a manual robot by implementing a holonomic drive system with force vector analysis and integrating an optical ray encoder for precise feedback. We also achieved the implementation of a servo-based gripper for locking and releasing mechanisms, accompanied by a highly accurate pneumatic system for the loading and throwing mechanism. The team led the development of a fully autonomous quadruped robot that incorporates Trot Gait analysis for improved performance. Furthermore, I designed the PCBs that served as the heart of both robots, including the 'PCB for Manual and Autonomous Robots', 'Battery Fuel Gauge', and 'LCD & Relay Breakout Board'.</p>
            <!-- Add a link to your PDF file here -->
            <p class="text-justify project-text">
                <a href="pdf/Design Detail Document 2019.pdf" target="_blank">View Design Detail Document (PDF)</a>
            </p>
        </div>
    </section>

</div>

<!-- Footer -->
<footer id="footer" class="wrapper alt">
    <div class="inner">
        <ul class="menu">
            <li>&copy; 2016-2025 Swapnil Meshram</li>
        </ul>
    </div>
</footer>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.scrollex.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

<script>
/* ──────────────────────────────────────────
   1.  MAIN SLIDER
────────────────────────────────────────── */
const $slider = $('.slider');

/* centre inline-carousel arrows on the active image */
function positionArrows () {
  const $img = $slider.find('.slick-current img');
  if (!$img.length) return;                       /* current slide is video */

  if (!$img[0].naturalHeight) {                   /* wait for lazy-loaded img */
    $img.on('load', positionArrows);
    return;
  }
  const imgBox   = $img[0].getBoundingClientRect();
  const slideBox = $slider[0].getBoundingClientRect();
  const mid      = imgBox.top + imgBox.height / 2 - slideBox.top;
  $slider.find('.slick-prev, .slick-next').css('top', mid + 'px');
}

$slider.on('init setPosition afterChange', positionArrows);

$slider.slick({
  autoplay: true,
  dots: true,
  arrows: true,
  infinite: true,
  speed: 800,
  cssEase: 'cubic-bezier(0.7,0,0.3,1)',
  slidesToShow: 1,
  slidesToScroll: 1
});

const slickInst = $slider.slick('getSlick');
$(window).on('resize orientationchange', positionArrows);

/* ──────────────────────────────────────────
   2.  UTILITY  – blur background when overlay is open
────────────────────────────────────────── */
function blurPage (on) {
  document.body.classList.toggle('fullscreen-mode', on);
  document.getElementById('wrapper').classList.toggle('blurred-background', on);
}

/* ──────────────────────────────────────────
   3.  FULL-SCREEN VIDEO OVERLAY
────────────────────────────────────────── */
function playFullScreen (videoSrc, autoPlay = false) {
  const ov = document.createElement('div');
  ov.className = 'fullscreen-video';
  ov.innerHTML = `
    <div class="close-button" onclick="closeFullScreen()"></div>
    <button class="slick-prev fs-arrow" aria-label="Previous">
      <i class="fas fa-chevron-left"></i>
    </button>
    <button class="slick-next fs-arrow" aria-label="Next">
      <i class="fas fa-chevron-right"></i>
    </button>

    <video src="${videoSrc}" playsinline muted style="opacity:0"></video>
    <div class="play-icon" aria-hidden="true"></div>
  `;
  document.body.appendChild(ov);
  blurPage(true);

  const vid     = ov.querySelector('video');
  const playBtn = ov.querySelector('.play-icon');
  vid.style.transform       = 'translate(0,0) scale(0.85)';
  vid.style.transformOrigin = 'center center';
  requestAnimationFrame(() => { vid.style.opacity = 1; });

  vid.addEventListener('play', () => {
    playBtn.style.display = 'none';
    vid.setAttribute('controls', '');
  });

  if (autoPlay) vid.play().catch(() => {});
  playBtn.addEventListener('click', () => vid.play());

  /* cross-fade to next / prev slide */
  function jump (dir) {
    vid.style.opacity = 0;
    vid.addEventListener('transitionend', function handle () {
      vid.removeEventListener('transitionend', handle);

      dir < 0 ? slickInst.slickPrev() : slickInst.slickNext();
      const slide = slickInst.$slides.eq(slickInst.currentSlide);
      const vSrc  = slide.find('video source').attr('src');

      if (vSrc) {                            /* next is video  */
        vid.pause();
        vid.removeAttribute('controls');
        playBtn.style.display = '';
        vid.src = vSrc;
        vid.load();
        requestAnimationFrame(() => { vid.style.opacity = 1; });
      } else {                               /* next is image */
        closeFullScreen();
        showFullScreenImage(slide.find('a.image').attr('href'));
      }
    });
  }
  ov.querySelector('.slick-prev').onclick = () => jump(-1);
  ov.querySelector('.slick-next').onclick = () => jump(1);

  document.addEventListener('keydown', function esc (e) {
    if (e.key === 'Escape') {
      document.removeEventListener('keydown', esc);
      closeFullScreen();
    }
  });
}

/* ──────────────────────────────────────────
   4.  FULL-SCREEN IMAGE OVERLAY
────────────────────────────────────────── */
function showFullScreenImage (src, evt) {
  if (evt) evt.preventDefault();

  let idx      = slickInst.currentSlide;
  const slide  = slickInst.$slides.eq(idx);

  /* if current slide is video, delegate */
  if (slide.find('video').length) {
    playFullScreen(slide.find('video source').attr('src'));
    return;
  }

  const ov = document.createElement('div');
  ov.className = 'fullscreen-image';
  ov.innerHTML = `
    <div class="close-button" onclick="closeFullScreen()"></div>
    <button class="slick-prev fs-arrow" aria-label="Previous">
      <i class="fas fa-chevron-left"></i>
    </button>
    <button class="slick-next fs-arrow" aria-label="Next">
      <i class="fas fa-chevron-right"></i>
    </button>
    <div class="zoom-controls">
      <button class="zoom-btn zoom-out"  aria-label="Zoom out"><i class="fas fa-minus"></i></button>
      <button class="zoom-btn zoom-reset" aria-label="Reset zoom"><i class="fas fa-search"></i></button>
      <button class="zoom-btn zoom-in"   aria-label="Zoom in"><i class="fas fa-plus"></i></button>
    </div>
    <img src="${src}" alt="" class="zoomable" loading="lazy">
  `;
  document.body.appendChild(ov);
  blurPage(true);

  const img = ov.querySelector('img.zoomable');

  /* ----- zoom & pan state ----- */
  let scale   = 0.85,
      offsetX = 0,
      offsetY = 0;
  img.style.transform = `translate(0,0) scale(${scale})`;

  /* swap slides (image or video) */
  function swapSlide () {
    const s   = slickInst.$slides.eq(idx);
    const vid = s.find('video source').attr('src');

    if (vid) { closeFullScreen(); playFullScreen(vid); return; }

    const newSrc = s.find('a.image').attr('href');
    img.style.opacity = 0;
    img.addEventListener('transitionend', function t () {
      img.removeEventListener('transitionend', t);
      img.src = newSrc;
      requestAnimationFrame(() => { img.style.opacity = 1; });
    });
  }

  ov.querySelector('.slick-prev').onclick = () => {
    idx = (idx - 1 + slickInst.slideCount) % slickInst.slideCount;
    swapSlide();
  };
  ov.querySelector('.slick-next').onclick = () => {
    idx = (idx + 1) % slickInst.slideCount;
    swapSlide();
  };

  /* ----- zoom helpers ----- */
  function update () {
    img.style.transform = `translate(${offsetX}px,${offsetY}px) scale(${scale})`;
  }
  ov.querySelector('.zoom-in').onclick    = () => { scale = Math.min(scale * 1.2, 3); update(); };
  ov.querySelector('.zoom-out').onclick   = () => { scale = Math.max(scale * 0.8, 0.5); update(); };
  ov.querySelector('.zoom-reset').onclick = () => { scale = 0.85; offsetX = offsetY = 0; update(); };

  ov.addEventListener('wheel', e => {
    e.preventDefault();
    scale *= e.deltaY < 0 ? 1.1 : 0.9;
    scale  = Math.min(Math.max(scale, 0.5), 3);
    update();
  }, { passive:false });

  /* drag-to-pan (mouse) */
  let dragging = false, sx, sy;
  img.addEventListener('mousedown', e => {
    e.preventDefault();
    dragging = true;
    sx = e.clientX; sy = e.clientY;
    img.style.cursor = 'grabbing';
  });
  document.addEventListener('mousemove', e => {
    if (!dragging) return;
    offsetX += e.clientX - sx; offsetY += e.clientY - sy;
    sx = e.clientX; sy = e.clientY;
    update();
  });
  document.addEventListener('mouseup', () => {
    dragging = false; img.style.cursor = 'grab';
  });
  ov.addEventListener('mouseleave', () => {
    dragging = false; img.style.cursor = 'grab';
  });

  /* pinch-to-zoom (touch) */
  function dist(t1, t2) { return Math.hypot(t1.clientX - t2.clientX,
                                           t1.clientY - t2.clientY); }
  let pinchStart = null, touchDrag = false, tx, ty;
  ov.addEventListener('touchstart', e => {
    if (e.touches.length === 2)      pinchStart = dist(e.touches[0], e.touches[1]);
    else if (e.touches.length === 1) { touchDrag = true; tx = e.touches[0].clientX; ty = e.touches[0].clientY; }
  }, { passive:false });
  ov.addEventListener('touchmove', e => {
    if (e.touches.length === 2 && pinchStart !== null) {
      e.preventDefault();
      scale = Math.min(Math.max(scale * (dist(e.touches[0], e.touches[1]) / pinchStart), 0.5), 3);
      pinchStart = dist(e.touches[0], e.touches[1]);
      update();
    } else if (e.touches.length === 1 && touchDrag) {
      e.preventDefault();
      offsetX += e.touches[0].clientX - tx;
      offsetY += e.touches[0].clientY - ty;
      tx = e.touches[0].clientX; ty = e.touches[0].clientY;
      update();
    }
  }, { passive:false });
  ov.addEventListener('touchend', e => {
    if (e.touches.length < 2) pinchStart = null;
    if (e.touches.length === 0) touchDrag = false;
  });

  document.addEventListener('keydown', function esc (e) {
    if (e.key === 'Escape') {
      document.removeEventListener('keydown', esc);
      closeFullScreen();
    }
  });
}

/* ──────────────────────────────────────────
   5.  CLOSE OVERLAY
────────────────────────────────────────── */
function closeFullScreen () {
  const ov =
    document.querySelector('.fullscreen-image') ||
    document.querySelector('.fullscreen-video');
  if (!ov) return;
  ov.remove();
  blurPage(false);
}
</script>

</body>
</html>
